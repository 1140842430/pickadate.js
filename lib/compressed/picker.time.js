/*!
 * pickadate.js v3.0.0-alpha,Â 2013-05-03
 * By Amsul (http://amsul.ca)
 * Hosted on http://amsul.github.io/pickadate.js
 * Licensed under MIT
 */
function TimePicker(e,t){var i=this,n=e.$node.data("value");i.settings=t,i.queue={interval:"i",min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"create validate",view:"create validate",disable:"flipItem",enable:"flipItem"},i.item={},i.item.interval=t.interval||30,i.item.disable=(t.disable||[]).slice(0),i.item.enable=-function(e){return e[0]===!0?e.shift():-1}(i.item.disable),i.set("min",t.min).set("max",t.max).set("now").set("select",n||e.$node[0].value||i.item.min,{format:n?t.formatSubmit:t.format}).set("highlight",i.item.select),i.key={40:1,38:-1,39:1,37:-1,go:function(e){i.set("highlight",i.item.highlight.pick+e*i.item.interval,{interval:e*i.item.interval}),this.render()}},i.onRender=function(){var e=this.$holder,n=e.find("."+t.klass.viewset);n.length?e[0].scrollTop=~~(n.position().top-n[0].clientHeight):console.warn("Nothing to viewset with",i.item.view)},i.onOpen=function(){this.$holder.find("button").attr("disable",!1)},i.onClose=function(){this.$holder.find("button").attr("disable",!0)}}var HOURS_IN_DAY=24,MINUTES_IN_HOUR=60,HOURS_TO_NOON=12,MINUTES_IN_DAY=HOURS_IN_DAY*MINUTES_IN_HOUR;TimePicker.prototype.set=function(e,t,i){var n=this;return n.item["enable"==e?"disable":"flip"==e?"enable":e]=n.queue[e].split(" ").map(function(r){return t=n[r](e,t,i)}).pop(),"highlight"==e?n.set("view",n.item.highlight,i):"interval"==e?n.set("min",n.item.min,i).set("max",n.item.max,i):("flip"==e||"min"==e||"max"==e||"disable"==e||"enable"==e)&&n.item.select&&n.item.highlight&&("min"==e&&n.set("max",n.item.max,i),n.set("select",n.item.select,i).set("highlight",n.item.highlight,i)),n},TimePicker.prototype.get=function(e){return this.item[e]},TimePicker.prototype.create=function(e,t,i){var n=this;return t=void 0===t?e:t,isObject(t)&&isInteger(t.pick)?t=t.pick:Array.isArray(t)?t=+t[0]*MINUTES_IN_HOUR+ +t[1]:isInteger(t)||(t=n.now(e,t,i)),"max"==e&&n.item.min.pick>t&&(t+=MINUTES_IN_DAY),t=n.normalize(t,i),{hour:~~(HOURS_IN_DAY+t/MINUTES_IN_HOUR)%HOURS_IN_DAY,mins:(MINUTES_IN_HOUR+t%MINUTES_IN_HOUR)%MINUTES_IN_HOUR,time:(MINUTES_IN_DAY+t)%MINUTES_IN_DAY,pick:t}},TimePicker.prototype.now=function(e,t){var i=new Date;return(isInteger(t)?t+1:1)*this.item.interval+i.getHours()*MINUTES_IN_HOUR+i.getMinutes()},TimePicker.prototype.normalize=function(e){return e-((0>e?this.item.interval:0)+e%this.item.interval)},TimePicker.prototype.measure=function(e,t,i){var n=this;return t?t===!0||isInteger(t)?t=n.now(e,t,i):isObject(t)&&isInteger(t.pick)&&(t=n.normalize(t.pick,i)):t="min"==e?[0,0]:[HOURS_IN_DAY-1,MINUTES_IN_HOUR-1],t},TimePicker.prototype.validate=function(e,t,i){var n=this,r=i&&i.interval?i.interval:n.item.interval;return n.disabled(t)&&(t=n.shift(t,r)),t=n.scope(t),n.disabled(t)&&(t=n.shift(t,-1*r)),t},TimePicker.prototype.disabled=function(e){var t=this,i=t.item.disable.filter(function(i){return isInteger(i)?e.hour==i:Array.isArray(i)?e.pick==t.create(i).pick:void 0}).length;return-1===t.item.enable?!i:i},TimePicker.prototype.shift=function(e,t){for(var i=this;i.disabled(e)&&(e=i.create(e.pick+=t||i.item.interval),!(e.pick<=i.item.min.pick||e.pick>=i.item.max.pick)););return e},TimePicker.prototype.scope=function(e){var t=this.item.min.pick,i=this.item.max.pick;return this.create(e.pick>i?i:t>e.pick?t:e)},TimePicker.prototype.parse=function(e,t,i){var n=this,r={};if(!t||isInteger(t)||Array.isArray(t)||isDate(t)||isObject(t)&&isInteger(t.pick))return t;if(!i||!i.format)throw"Need a formatting option to parse this..";return n.formats.toArray(i.format).map(function(e){var i=n.formats[e],o=i?triggerFunction(i,n,[t,r]):e.replace(/^!/,"").length;i&&(r[e]=t.substr(0,o)),t=t.substr(o)}),+r.i+MINUTES_IN_HOUR*(+(r.H||r.HH)||+(r.h||r.hh)+(/^p/i.test(r.A||r.a)?12:0))},TimePicker.prototype.formats={h:function(e,t){return e?getDigitsLength(e):t.hour%HOURS_TO_NOON||HOURS_TO_NOON},hh:function(e,t){return e?2:leadZero(t.hour%HOURS_TO_NOON||HOURS_TO_NOON)},H:function(e,t){return e?getDigitsLength(e):""+t.hour},HH:function(e,t){return e?getDigitsLength(e):leadZero(t.hour)},i:function(e,t){return e?2:leadZero(t.mins)},a:function(e,t){return e?4:MINUTES_IN_DAY/2>t.time%MINUTES_IN_DAY?"a.m.":"p.m."},A:function(e,t){return e?2:MINUTES_IN_DAY/2>t.time%MINUTES_IN_DAY?"AM":"PM"},toArray:function(e){return e.split(/(h{1,2}|H{1,2}|i|a|A|!.)/g)},toString:function(e,t){var i=this;return i.formats.toArray(e).map(function(e){return triggerFunction(i.formats[e],i,[0,t])||e.replace(/^!/,"")}).join("")}},TimePicker.prototype.flipItem=function(e,t){var i=this,n=i.item.disable,r=-1===i.item.enable;return"flip"==t?i.item.enable=r?1:-1:!r&&"enable"==e||r&&"disable"==e?n=i.removeDisabled(n,t):(!r&&"disable"==e||r&&"enable"==e)&&(n=i.addDisabled(n,t)),n},TimePicker.prototype.addDisabled=function(e,t){var i=this;return t.map(function(t){i.filterDisabled(e,t).length||e.push(t)}),e},TimePicker.prototype.removeDisabled=function(e,t){var i=this;return t.map(function(t){e=i.filterDisabled(e,t,1)}),e},TimePicker.prototype.filterDisabled=function(e,t,i){var n=Array.isArray(t);return e.filter(function(e){var r=!n&&t===e||n&&Array.isArray(e)&&""+t==""+e;return i?!r:r})},TimePicker.prototype.i=function(e,t){return isInteger(t)&&t>0?t:this.item.interval},TimePicker.prototype.nodes=function(e){var t=this,i=t.settings,n=t.item.select,r=t.item.highlight,o=t.item.view,a=t.item.disable;return createNode("ul",createGroupOfNodes({min:t.item.min.pick,max:t.item.max.pick,i:t.item.interval,node:"li",item:function(e){return e=t.create(e),[triggerFunction(t.formats.toString,t,[i.formatLabel||i.format,e]),function(s,c){return n&&n.pick==c&&s.push(i.klass.selected),r&&r.pick==c&&s.push(i.klass.highlighted),o&&o.pick==c&&s.push(i.klass.viewset),a&&t.disabled(e)&&s.push(i.klass.disabled),s.join(" ")}([i.klass.listItem],e.pick),"data-pick="+e.pick]}})+createNode("li",createNode("button",i.clear,i.klass.buttonClear,"data-clear=1"+(e?"":" disable"))),i.klass.list)},Picker.extend("pickatime",TimePicker,{clear:"Clear",format:"h:i A",interval:30,klass:{input:CLASSES_PREFIX+"input",active:CLASSES_PREFIX+"input--active",holder:CLASSES_PREFIX+"holder "+CLASSES_PREFIX+"holder--time",opened:CLASSES_PREFIX+"holder--opened",focused:CLASSES_PREFIX+"holder--focused",frame:CLASSES_PREFIX+"frame",wrap:CLASSES_PREFIX+"wrap",box:CLASSES_PREFIX+"box",list:CLASSES_PREFIX+"list",listItem:CLASSES_PREFIX+"list-item",disabled:CLASSES_PREFIX+"list-item--disabled",selected:CLASSES_PREFIX+"list-item--selected",highlighted:CLASSES_PREFIX+"list-item--highlighted",viewset:CLASSES_PREFIX+"list-item--viewset",now:CLASSES_PREFIX+"list-item--now",buttonClear:CLASSES_PREFIX+"button--clear"}});