/*!
 * pickadate.js v3.0.0alpha,Â 2013-04-30
 * By Amsul (http://amsul.ca)
 * Hosted on http://amsul.github.io/pickadate.js
 * Licensed under MIT
 */
(function(e,t,n){"use strict";function i(i,o,a,l){function u(){return r("div",r("div",r("div",y.component.nodes(h.open),f.box),f.wrap),f.frame)}function m(){y.open(),y.$holder.addClass(f.focused)}var h={id:Math.abs(~~(1e9*Math.random()))},f=o.klass,g=i[0],v=function(){return this.start()},y=v.prototype={constructor:v,$node:i,start:function(){return h&&h.start?y:(h.methods={},h.start=!0,h.open=!1,h.type=g.type,g.autofocus=g==t.activeElement,g.type="text",g.readOnly=!0,y.component=new a(y,o),y.$holder=e(r("div",u(),f.holder)).on({focusin:function(e){y.$holder.removeClass(f.focused),e.stopPropagation()},mousedown:function(e){e.target!=y.$holder[0]&&e.stopPropagation()},click:function(n){var i=n.target,o=e(i),r=o.data();i!=y.$holder[0]&&(n.stopPropagation(),!y.$holder.find(t.activeElement).length&&h.open&&g.focus(),r.nav&&!o.hasClass(f.navDisabled)?y.set("highlight",y.component.item.highlight,{nav:r.nav}):d(r.pick)&&!o.hasClass(f.disabled)?y.set({select:r.pick,highlight:r.pick}).close(!0):r.clear&&y.clear().close(!0))}}),y._hidden=o.formatSubmit?e("<input type=hidden name="+g.name+(o.hiddenSuffix||"_submit")+(i.data("value")?' value="'+s(y.component.formats.toString,y.component,[o.formatSubmit,y.component.item.select]):"")+'">')[0]:n,i.addClass(f.input).on("focus.P"+h.id,m).on("click.P"+h.id,y.open).on("change.P"+h.id,function(){y._hidden&&(y._hidden.value=g.value?s(y.component.formats.toString,y.component,[o.formatSubmit,y.component.item.select]):"")}).on("keydown.P"+h.id,function(e){var t=e.keyCode,n=/^(8|46)$/.test(t);(32==t||n||!h.open&&y.component.key[t])&&(e.preventDefault(),e.stopPropagation(),n?y.clear().close():y.open())}).val(i.data("value")?s(y.component.formats.toString,y.component,[o.format,y.component.item.select]):"").after(y.$holder,y._hidden).data(l,y),y.on("start",y.component.onStart).on("start",o.onStart).on("render",y.component.onRender).on("render",o.onRender).on("stop",y.component.onStop).on("stop",o.onStop).on("open",y.component.onOpen).on("open",o.onOpen).on("close",y.component.onClose).on("close",o.onClose).on("set",y.component.onSet).on("set",o.onSet),g.autofocus&&y.open(),y.trigger("start").trigger("render"))},render:function(){return y.$holder.html(u()),y.trigger("render")},stop:function(){return h.start?(y.close(),y._hidden&&y._hidden.parentNode.removeChild(y._hidden),y.$holder.remove(),i.removeClass(f.input).off(".P"+h.id).removeData(l),g.type=h.type,g.readOnly=!1,y.trigger("stop"),h.methods={},h.start=!1,y):y},open:function(){return h.open?y:(h.open=!0,i.focus().addClass(f.active),y.$holder.addClass(f.opened),p.on("click.P"+h.id+" focusin.P"+h.id,function(e){e.target!=g&&e.target!=t&&y.close()}).on("keydown.P"+h.id,function(e){var t=e.keyCode,n=y.component.key[t],i=e.target;27==t?y.close(!0):i!=g||!n&&13!=t?y.$holder.find(i).length&&13==t&&(e.preventDefault(),i.click()):(e.preventDefault(),n?s(y.component.key.go,y,[n]):y.set("select",y.component.item.highlight).close())}),y.trigger("open"))},close:function(e){return e&&(i.off("focus.P"+h.id).focus(),setTimeout(function(){i.on("focus.P"+h.id,m)},0)),h.open?(h.open=!1,i.removeClass(f.active),y.$holder.removeClass(f.opened).removeClass(f.focused),p.off(".P"+h.id),y.trigger("close")):y},clear:function(){return y.set("clear")},set:function(e,t,n){var r,a,l=c(e),u=l?e:{};if(e){l||(u[e]=t);for(r in u)a=u[r],y.component.item[r]&&y.component.set(r,a,n||{}),("select"==r||"clear"==r)&&i.val("clear"==r?"":s(y.component.formats.toString,y.component,[o.format,y.component.get(r)])).trigger("change");y.render()}return y.trigger("set",u)},get:function(e,t){return e=e||"value",null!=h[e]?h[e]:"value"==e?g.value:y.component.item[e]?"string"==typeof t?s(y.component.formats.toString,y.component,[t,y.component.get(e)]):y.component.get(e):n},on:function(e,t){return h.methods[e]=h.methods[e]||[],h.methods[e].push(t),y},trigger:function(e,t){var n=h.methods[e];return n&&n.map(function(e){s(e,y,[t])}),y}};return new v}function o(e){for(var t,n="",i=s(e.min,e);s(e.max,e,[i])>=i;i+=e.i)t=s(e.item,e,[i]),n+=r(e.node,t[0],t[1],t[2]);return n}function r(e,t,n,i){return t?(t=Array.isArray(t)?t.join(""):t,n=n?' class="'+n+'"':"",i=i?" "+i:"","<"+e+n+i+">"+t+"</"+e+">"):""}function a(e){return(10>e?"0":"")+e}function s(e,t,n){return"function"==typeof e?e.apply(t,n||[]):e}function l(e){return/\d/.test(e[1])?2:1}function c(e){return{}.toString.call(e).indexOf("Object")>-1}function u(e){return{}.toString.call(e).indexOf("Date")>-1}function d(e){return{}.toString.call(e).indexOf("Number")>-1&&0===e%1}function m(e,t){var n=this,i=e.$node.data("value");n.settings=t,n.queue={interval:"i",min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"create validate",view:"create validate",disable:"flipItem",enable:"flipItem"},n.item={},n.item.interval=t.interval||30,n.item.disable=(t.disable||[]).slice(0),n.item.enable=-function(e){return e[0]===!0?e.shift():-1}(n.item.disable),n.set("min",t.min).set("max",t.max).set("now").set("select",i||e.$node[0].value||n.item.min,{format:i?t.formatSubmit:t.format}).set("highlight",n.item.select),n.key={40:1,38:-1,39:1,37:-1,go:function(e){n.set("highlight",n.item.highlight.pick+e*n.item.interval,{interval:e*n.item.interval}),this.render()}},n.onRender=function(){var e=this.$holder,i=e.find("."+t.klass.viewset);i.length?e[0].scrollTop=~~(i.position().top-i[0].clientHeight):console.warn("Nothing to viewset with",n.item.view)},n.onOpen=function(){this.$holder.find("button").attr("disable",!1)},n.onClose=function(){this.$holder.find("button").attr("disable",!0)}}var h="picker__",p=e(t);i.extend=function(t,n,o){e.fn[t]=function(o,r){var a=this.data(t);return a&&"string"==typeof o?"picker"==o?a:s(a[o],a,[r]):this.each(function(){var r=e(this);r.data(t)||new i(r,e.extend(!0,{},e.fn[t].defaults,o),n,t)})},e.fn[t].defaults=o};var f=24,g=60,v=12,y=f*g;m.prototype.set=function(e,t,n){var i=this;return i.item["enable"==e?"disable":"flip"==e?"enable":e]=i.queue[e].split(" ").map(function(o){return t=i[o](e,t,n)}).pop(),"highlight"==e?i.set("view",i.item.highlight,n):"interval"==e?i.set("min",i.item.min,n).set("max",i.item.max,n):("flip"==e||"min"==e||"max"==e||"disable"==e||"enable"==e)&&i.item.select&&i.item.highlight&&("min"==e&&i.set("max",i.item.max,n),i.set("select",i.item.select,n).set("highlight",i.item.highlight,n)),i},m.prototype.get=function(e){return this.item[e]},m.prototype.create=function(e,t,i){var o=this;return t=t===n?e:t,c(t)&&d(t.pick)?t=t.pick:Array.isArray(t)?t=+t[0]*g+ +t[1]:d(t)||(t=o.now(e,t,i)),"max"==e&&o.item.min.pick>t&&(t+=y),t=o.normalize(t,i),{hour:~~(f+t/g)%f,mins:(g+t%g)%g,time:(y+t)%y,pick:t}},m.prototype.now=function(e,t){var n=new Date;return(d(t)?t+1:1)*this.item.interval+n.getHours()*g+n.getMinutes()},m.prototype.normalize=function(e){return e-((0>e?this.item.interval:0)+e%this.item.interval)},m.prototype.measure=function(e,t,n){var i=this;return t?t===!0||d(t)?t=i.now(e,t,n):c(t)&&d(t.pick)&&(t=i.normalize(t.pick,n)):t="min"==e?[0,0]:[f-1,g-1],t},m.prototype.validate=function(e,t,n){var i=this,o=n&&n.interval?n.interval:i.item.interval;return i.disabled(t)&&(t=i.shift(t,o)),t=i.scope(t),i.disabled(t)&&(t=i.shift(t,-1*o)),t},m.prototype.disabled=function(e){var t=this,i=t.item.disable.filter(function(i){return d(i)?e.hour==i:Array.isArray(i)?e.pick==t.create(i).pick:n}).length;return-1===t.item.enable?!i:i},m.prototype.shift=function(e,t){for(var n=this;n.disabled(e)&&(e=n.create(e.pick+=t||n.item.interval),!(e.pick<=n.item.min.pick||e.pick>=n.item.max.pick)););return e},m.prototype.scope=function(e){var t=this.item.min.pick,n=this.item.max.pick;return this.create(e.pick>n?n:t>e.pick?t:e)},m.prototype.parse=function(e,t,n){var i=this,o={};if(!t||d(t)||Array.isArray(t)||u(t)||c(t)&&d(t.pick))return t;if(!n||!n.format)throw"Need a formatting option to parse this..";return i.formats.toArray(n.format).map(function(e){var n=i.formats[e],r=n?s(n,i,[t,o]):e.replace(/^!/,"").length;n&&(o[e]=t.substr(0,r)),t=t.substr(r)}),+o.i+g*(+(o.H||o.HH)||+(o.h||o.hh)+(/^p/i.test(o.A||o.a)?12:0))},m.prototype.formats={h:function(e,t){return e?l(e):t.hour%v||v},hh:function(e,t){return e?2:a(t.hour%v||v)},H:function(e,t){return e?l(e):""+t.hour},HH:function(e,t){return e?l(e):a(t.hour)},i:function(e,t){return e?2:a(t.mins)},a:function(e,t){return e?4:y/2>t.time%y?"a.m.":"p.m."},A:function(e,t){return e?2:y/2>t.time%y?"AM":"PM"},toArray:function(e){return e.split(/(h{1,2}|H{1,2}|i|a|A|!.)/g)},toString:function(e,t){var n=this;return n.formats.toArray(e).map(function(e){return s(n.formats[e],n,[0,t])||e.replace(/^!/,"")}).join("")}},m.prototype.flipItem=function(e,t){var n=this,i=n.item.disable,o=-1===n.item.enable;return"flip"==t?n.item.enable=o?1:-1:!o&&"enable"==e||o&&"disable"==e?i=n.removeDisabled(i,t):(!o&&"disable"==e||o&&"enable"==e)&&(i=n.addDisabled(i,t)),i},m.prototype.addDisabled=function(e,t){var n=this;return t.map(function(t){n.filterDisabled(e,t).length||e.push(t)}),e},m.prototype.removeDisabled=function(e,t){var n=this;return t.map(function(t){e=n.filterDisabled(e,t,1)}),e},m.prototype.filterDisabled=function(e,t,n){var i=Array.isArray(t);return e.filter(function(e){var o=!i&&t===e||i&&Array.isArray(e)&&""+t==""+e;return n?!o:o})},m.prototype.i=function(e,t){return d(t)&&t>0?t:this.item.interval},m.prototype.nodes=function(e){var t=this,n=t.settings,i=t.item.select,a=t.item.highlight,l=t.item.view,c=t.item.disable;return r("ul",o({min:t.item.min.pick,max:t.item.max.pick,i:t.item.interval,node:"li",item:function(e){return e=t.create(e),[s(t.formats.toString,t,[n.formatLabel||n.format,e]),function(o,r){return i&&i.pick==r&&o.push(n.klass.selected),a&&a.pick==r&&o.push(n.klass.highlighted),l&&l.pick==r&&o.push(n.klass.viewset),c&&t.disabled(e)&&o.push(n.klass.disabled),o.join(" ")}([n.klass.listItem],e.pick),"data-pick="+e.pick]}})+r("li",r("button",n.clear,n.klass.buttonClear,"data-clear=1"+(e?"":" disable"))),n.klass.list)},i.extend("pickatime",m,{clear:"Clear",format:"h:i A",interval:30,klass:{input:h+"input",active:h+"input--active",holder:h+"holder "+h+"holder--time",opened:h+"holder--opened",focused:h+"holder--focused",frame:h+"frame",wrap:h+"wrap",box:h+"box",list:h+"list",listItem:h+"list-item",disabled:h+"list-item--disabled",selected:h+"list-item--selected",highlighted:h+"list-item--highlighted",viewset:h+"list-item--viewset",now:h+"list-item--now",buttonClear:h+"button--clear"}})})(jQuery,document);